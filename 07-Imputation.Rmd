## Imputation

As stated in the analytic plan, data was imputed prior to conducting mixed effects models, with 10 iterations on 20 imputated datasets 

The predictor matrix is presented in Table \@ref(tab:predmat) ; the percent missing for each variable prior to imputation is presented in Supplemental Table \@ref(tab:pobs-girls) for girls and Supplemental Table \@ref(tab:pobs-boys) for boys. In addition, tables \@ref(tab:pobs-girls) and \@ref(tab:pobs-boys) report the influx (overall number of variable pairs \((Y_j,Y_k)\) with \(Y_j\) missing and \(Y_k\) observed, divided by the total number of observed data cells), and outflux (the number of variable pairs with \(Y_j\) observed and \(Y_k\) missing, divided by the total number of incomplete data cells) for each variable. The influx refers to connection to the observed data (ease of imputation, with one representing the highest level of connection to the observed data) the outflux refers to potential contribution to this variable in imputing other data, both on a 0-1 scale with one representing the highest possible levels of influx/outflux. Overall, there was moderate levels of missingness in the current data.

```{r pobs-girls}
load('data/glm_mice_girls/glm_mice_girls.Rdata')
pobs <- mice::flux(mi.res$data)[,1:3]
pobs$`Percent Missing` <- 100 - round(pobs$pobs*100, 2)
pobs <- pobs |> 
  select (c(`Percent Missing`, influx, outflux)) |> 
  round(2) |> 
  rownames_to_column() |> 
  rename('Variable' = rowname) |> 
  rename('Influx' = influx) |> 
  rename('Outflux' = outflux) |> 
  filter(!(Variable %in% c('id', 'age_adjust', 'education_mum', 'education_partner')))

pobs['Variable'][pobs['Variable'] == 'parent_highest_occupation'] <- 'Parent SES'
pobs['Variable'][pobs['Variable'] == 'bmi_z_bestavail'] <- 'BMI Z - Age 13'
pobs['Variable'][pobs['Variable'] == 'fear_wtgain_14'] <- 'Fear of Wt Gain - Age 14'
pobs['Variable'][pobs['Variable'] == 'body_sat_mean_14_std'] <- 'Body Satisifaction - Age 14'
pobs['Variable'][pobs['Variable'] == 'ti_mean_14_std'] <- 'Thin-ideal Internalization - Age 14'
pobs['Variable'][pobs['Variable'] == 'driven_exercise'] <- 'Maladaptive Exercise'
pobs['Variable'][pobs['Variable'] == 'exercise_wtloss'] <- 'Exercise for Weight Loss'

knitr::kable(pobs, 
             caption = 'Missing Data Prior to Imputation - Girls')
```

```{r pobs-boys}
load('data/glm_mice_boys/glm_mice_boys.Rdata')
pobs <- mice::flux(mi.res$data)[,1:3]
pobs$`Percent Missing` <- 100 - round(pobs$pobs*100, 2)
pobs <- pobs |> 
  select (c(`Percent Missing`, influx, outflux)) |> 
  round(2) |> 
  rownames_to_column() |> 
  rename('Variable' = rowname) |> 
  rename('Influx' = influx) |> 
  rename('Outflux' = outflux) |> 
  filter(!(Variable %in% c('id', 'age_adjust', 'education_mum', 'education_partner')))

pobs['Variable'][pobs['Variable'] == 'parent_highest_occupation'] <- 'Parent SES'
pobs['Variable'][pobs['Variable'] == 'bmi_z_bestavail'] <- 'BMI Z - Age 13'
pobs['Variable'][pobs['Variable'] == 'fear_wtgain_14'] <- 'Fear of Wt Gain - Age 14'
pobs['Variable'][pobs['Variable'] == 'body_sat_mean_14_std'] <- 'Body Satisifaction - Age 14'
pobs['Variable'][pobs['Variable'] == 'ti_mean_14_std'] <- 'Thin-ideal Internalization - Age 14'
pobs['Variable'][pobs['Variable'] == 'driven_exercise'] <- 'Maladaptive Exercise'
pobs['Variable'][pobs['Variable'] == 'exercise_wtloss'] <- 'Exercise for Weight Loss'

knitr::kable(pobs, 
             caption = 'Missing Data Prior to Imputation - Boys')

````
