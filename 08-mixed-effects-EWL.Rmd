
## Mixed-Effect Models - Exercise for Weight Loss

The same multilevel modeling approach was used to examine endorsement of EWL over time in the sample, substituting a cummulative-link modeling approach to accommodate the ordinal outcome of EWL frequency.To compare models with imputed datasets with ordinal outcomes implemented in R, we estimated the improvement in fit of models by examining the mean AIC of all 20 models for imputed data, along with the mean difference in log liklihood when comparing all nested models on all iterations of imputed datasets. Summary statistics for model comparisons are presented in table \@ref(tab:ewl-mcomp-girls) for Girls and table \@ref(tab:ewl-mcomp-boys) for boys

### Girls

Overall, the most complex model (including Age x Covariate interactions) was identified as the best model for girls, both in terms of the median -2 log likelihood difference comparison as well as via the lowest AIC. 

```{r ewl-mcomp-girls}
load('models/ewl_mcomp_tables.Rdata')
knitr::kable(girls_mcomp_table,
             caption = "Model Comparison Table for Exercise for Weight Loss - Girls")
```
With regrads to specfic predictors, Age, Parent SES, Body Mass Index at age 13, Thin-ideal interanlization, and Fear of Weight gain all emerged as significant positive predictors of frequency of exercise for weight loss (see Table \@ref(tab:ewl-coefs-girls) for coefficients). Body dissatisfaction was the only ED cognition variable that was not significant



```{r ewl-coefs-girls, label = 'EWL Poled Coeffs Table - Girls'}

load('models/Girl_models_EWL_Output')

dfnames <- c('age_1_EWL_girls_ORs', 'covs_2_EWL_girls_ORs', 'covs_3_EWL_girls_ORs', 'covs_4_EWL_girls_ORs')
pooled_coefs <- do.call(rbind, lapply(dfnames, function(x) cbind(get(x), Model=x))) |> 
  relocate(Model) %>% 
  select(-c(p.value, statistic, df, `2.5 %`, `97.5 %`, `0.25 %`, `99.75 %`, std.error, estimate))

for (i in 3:ncol(pooled_coefs) ) {
  pooled_coefs[i] <- round(pooled_coefs[i], digits = 3)
}

pooled_coefs['Model'][pooled_coefs['Model'] == 'age_1_EWL_girls_ORs'] <- 'Age Effect Model'
pooled_coefs['Model'][pooled_coefs['Model'] == 'covs_2_EWL_girls_ORs'] <- 'Step 1 Covariates'
pooled_coefs['Model'][pooled_coefs['Model'] == 'covs_3_EWL_girls_ORs'] <- 'Step 2 Covariates'
pooled_coefs['Model'][pooled_coefs['Model'] == 'covs_4_EWL_girls_ORs'] <- 'Step 3 Age x Cov Interactions'

pooled_coefs <- pooled_coefs |> mutate(term = as.character(term))
pooled_coefs['term'][pooled_coefs['term'] == 'parent_highest_occupation'] <- 'Parent SES'
pooled_coefs['term'][pooled_coefs['term'] == 'bmi_z_bestavail'] <- 'BMI Z - Age 13'
pooled_coefs['term'][pooled_coefs['term'] == 'age_adjust'] <- 'Age'
pooled_coefs['term'][pooled_coefs['term'] == 'fear_wtgain_14'] <- 'Fear of Wt Gain - Age 14'
pooled_coefs['term'][pooled_coefs['term'] == 'body_sat_mean_14_std'] <- 'Body Satisifaction - Age 14'
pooled_coefs['term'][pooled_coefs['term'] == 'ti_mean_14_std'] <- 'Thin-ideal Internalization - Age 14'
pooled_coefs['term'][pooled_coefs['term'] == 'age_adjust:bmi_z_bestavail'] <- 'Age x BMI (13)'
pooled_coefs['term'][pooled_coefs['term'] == 'age_adjust:fear_wtgain_14'] <- 'Age x Fear of Wt Gain (14)'
pooled_coefs['term'][pooled_coefs['term'] == 'age_adjust:body_sat_mean_14_std'] <- 'Age x Body Satisfaction (14)'
pooled_coefs['term'][pooled_coefs['term'] == 'age_adjust:ti_mean_14_std'] <- 'Age x Thin-Ideal Internalization (14)'


pooled_coefs_ewl_girls <- pooled_coefs|> 
  kbl(caption = 'Table 1: Parameter Estimates for Models Predicting Exercise for Weight Loss in Girls') %>% 
  row_spec(c(4:8, 17:28), background = '#E0E0E0') %>% 
  column_spec(2:3, color = case_when(pooled_coefs$`OR LCI` > 1  ~ "blue",
                                   pooled_coefs$`OR HCI`< 1  ~ "red", 
                                   TRUE ~ 'black')) |> 
  kable_paper(full_width = T)

pooled_coefs_ewl_girls

```


### Boys


```{r ewl-mcomp-boys}
load('models/ewl_mcomp_tables.Rdata')
knitr::kable(girls_mcomp_table,
             caption = "Model Comparison Table for Exercise for Weight Loss - Girls")
```

Specific Parameters and coefficients are presented in Table \@ref(tab:ewl-coefs-boys)

```{r ewl-coefs-boys, label = 'EWL Poled Coeffs Table - boys'}

load('models/boy_models_EWL_output')

dfnames <- c('age_1_EWL_boys_ORs', 'covs_2_EWL_boys_ORs', 'covs_3_EWL_boys_ORs', 'covs_4_EWL_boys_ORs')
pooled_coefs <- do.call(rbind, lapply(dfnames, function(x) cbind(get(x), Model=x))) |> 
  relocate(Model) %>% 
  select(-c(p.value, statistic, df, `2.5 %`, `97.5 %`, `0.25 %`, `99.75 %`, std.error, estimate))

for (i in 3:ncol(pooled_coefs) ) {
  pooled_coefs[i] <- round(pooled_coefs[i], digits = 3)
}

pooled_coefs['Model'][pooled_coefs['Model'] == 'age_1_EWL_boys_ORs'] <- 'Age Effect Model'
pooled_coefs['Model'][pooled_coefs['Model'] == 'covs_2_EWL_boys_ORs'] <- 'Step 1 Covariates'
pooled_coefs['Model'][pooled_coefs['Model'] == 'covs_3_EWL_boys_ORs'] <- 'Step 2 Covariates'
pooled_coefs['Model'][pooled_coefs['Model'] == 'covs_4_EWL_boys_ORs'] <- 'Step 3 Age x Cov Interactions'

pooled_coefs <- pooled_coefs |> mutate(term = as.character(term))
pooled_coefs['term'][pooled_coefs['term'] == 'parent_highest_occupation'] <- 'Parent SES'
pooled_coefs['term'][pooled_coefs['term'] == 'bmi_z_bestavail'] <- 'BMI Z - Age 13'
pooled_coefs['term'][pooled_coefs['term'] == 'age_adjust'] <- 'Age'
pooled_coefs['term'][pooled_coefs['term'] == 'fear_wtgain_14'] <- 'Fear of Wt Gain - Age 14'
pooled_coefs['term'][pooled_coefs['term'] == 'body_sat_mean_14_std'] <- 'Body Satisifaction - Age 14'
pooled_coefs['term'][pooled_coefs['term'] == 'ti_mean_14_std'] <- 'Thin-ideal Internalization - Age 14'
pooled_coefs['term'][pooled_coefs['term'] == 'age_adjust:bmi_z_bestavail'] <- 'Age x BMI (13)'
pooled_coefs['term'][pooled_coefs['term'] == 'age_adjust:fear_wtgain_14'] <- 'Age x Fear of Wt Gain (14)'
pooled_coefs['term'][pooled_coefs['term'] == 'age_adjust:body_sat_mean_14_std'] <- 'Age x Body Satisfaction (14)'
pooled_coefs['term'][pooled_coefs['term'] == 'age_adjust:ti_mean_14_std'] <- 'Age x Thin-Ideal Internalization (14)'


pooled_coefs_ewl_boys <- pooled_coefs|> 
  kbl(caption = 'Table 1: Parameter Estimates for Models Predicting Exercise for Weight Loss in Boys') %>% 
  row_spec(c(4:8, 17:28), background = '#E0E0E0') %>% 
  column_spec(2:3, color = case_when(pooled_coefs$`OR LCI` > 1  ~ "blue",
                                   pooled_coefs$`OR HCI`< 1  ~ "red", 
                                   TRUE ~ 'black')) |> 
  kable_paper(full_width = T)

pooled_coefs_ewl_boys

```

